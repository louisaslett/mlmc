<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multi-level Monte Carlo estimation test suite — mlmc.test • mlmc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Multi-level Monte Carlo estimation test suite — mlmc.test"><meta name="description" content="Computes a suite of diagnostic values for an MLMC estimation problem."><meta property="og:description" content="Computes a suite of diagnostic values for an MLMC estimation problem."><meta property="og:image" content="https://mlmc.louisaslett.com/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mlmc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://people.maths.ox.ac.uk/~gilesm/mlmc/">Mike Giles MLMC page</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/louisaslett/mlmc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multi-level Monte Carlo estimation test suite</h1>
      <small class="dont-index">Source: <a href="https://github.com/louisaslett/mlmc/blob/v2.1.1/R/mlmc.test.R" class="external-link"><code>R/mlmc.test.R</code></a></small>
      <div class="d-none name"><code>mlmc.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes a suite of diagnostic values for an MLMC estimation problem.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mlmc.test</span><span class="op">(</span></span>
<span>  <span class="va">mlmc_l</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">L</span>,</span>
<span>  <span class="va">N0</span>,</span>
<span>  <span class="va">eps.v</span>,</span>
<span>  <span class="va">Lmin</span>,</span>
<span>  <span class="va">Lmax</span>,</span>
<span>  alpha <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  gamma <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mlmc-l">mlmc_l<a class="anchor" aria-label="anchor" href="#arg-mlmc-l"></a></dt>
<dd><p>a user supplied function which provides the estimate for level \(l\).
       It must take at least two arguments, the first is the level number to be simulated and the second the number of paths.
       Additional arguments can be taken if desired: all additional <code>...</code> arguments to this function are forwarded to the user defined <code>mlmc_l</code> function.</p>
<p>The user supplied function should return a named list containing one element named <code>sums</code> and second named <code>cost</code>, where:</p><dl><dt><code>sums</code></dt>
<dd><p>is a vector of length six \(\left(\sum Y_i, \sum Y_i^2, \sum Y_i^3, \sum Y_i^4, \sum X_i, \sum X_i^2\right)\) where \(Y_i\) are iid simulations with expectation \(E[P_0]\) when \(l=0\) and expectation \(E[P_l-P_{l-1}]\) when \(l&gt;0\), and \(X_i\) are iid simulations with expectation \(E[P_l]\).
                            Note that this differs from the main <code><a href="mlmc.html">mlmc()</a></code> driver, which only requires the first two of these elements in order to calculate the estimate.
                            The remaining elements are required by <code>mlmc.test()</code> since they are used for convergence tests, kurtosis, and telescoping sum checks.</p></dd>

         <dt><code>cost</code></dt>
<dd><p>is a scalar with the total cost of the paths simulated.
                            For example, in the financial options samplers included in this package, this is calculated as \(NM^l\), where \(N\) is the number of paths requested in the call to the user function <code>mlmc_l</code>, \(M\) is the refinement cost factor (\(M=2\) for <code><a href="mcqmc06_l.html">mcqmc06_l()</a></code> and \(M=4\) for <code><a href="opre_l.html">opre_l()</a></code>), and \(l\) is the level being sampled.</p></dd>


</dl><p>See the function (and source code of) <code><a href="opre_l.html">opre_l()</a></code> and <code><a href="mcqmc06_l.html">mcqmc06_l()</a></code> in this package for an example of user supplied level samplers.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of samples to use in convergence tests, kurtosis, telescoping sum check.</p></dd>


<dt id="arg-l">L<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>number of levels to use in convergence tests, kurtosis, telescoping sum check.</p></dd>


<dt id="arg-n-">N0<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>initial number of samples which are used for the first 3 levels and for any subsequent levels which are automatically added in the complexity tests.
Must be \(&gt; 0\).</p></dd>


<dt id="arg-eps-v">eps.v<a class="anchor" aria-label="anchor" href="#arg-eps-v"></a></dt>
<dd><p>a vector of one or more target accuracies for the complexity tests.
Must all be \(&gt; 0\).</p></dd>


<dt id="arg-lmin">Lmin<a class="anchor" aria-label="anchor" href="#arg-lmin"></a></dt>
<dd><p>the minimum level of refinement for complexity tests.
Must be \(\ge 2\).</p></dd>


<dt id="arg-lmax">Lmax<a class="anchor" aria-label="anchor" href="#arg-lmax"></a></dt>
<dd><p>the maximum level of refinement for complexity tests.
Must be \(\ge\) <code>Lmin</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>the weak error, \(O(2^{-\alpha l})\).
Must be \(&gt; 0\) if specified.
If <code>NA</code> then <code>alpha</code> will be estimated.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>the variance, \(O(2^{-\beta l})\).
Must be \(&gt; 0\) if specified.
If <code>NA</code> then <code>beta</code> will be estimated.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>the sample cost, \(O(2^{\gamma l})\).
Must be \(&gt; 0\) if specified.
If <code>NA</code> then <code>gamma</code> will be estimated.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>if an integer is supplied, R will fork <code>parallel</code> parallel processes.
This is done for the convergence tests section by splitting the <code>N</code> samples as evenly as possible across cores when sampling each level.
This is also done for the MLMC complexity tests by passing the <code>parallel</code> argument on to the <code><a href="mlmc.html">mlmc()</a></code> driver when targeting each accuracy level in <code>eps</code>.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>set to TRUE to supress running output (identical output can still be printed by printing the return result)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments which are passed on when the user supplied <code>mlmc_l</code> function is called</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>mlmc.test</code> object which contains all the computed diagnostic values.
        This object can be printed or plotted (see <code><a href="plot.mlmc.test.html">plot.mlmc.test</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See one of the example level sampler functions (e.g. <code><a href="opre_l.html">opre_l()</a></code>) for example usage.</p>
<p>This function is based on GPL-2 'Matlab' code by Mike Giles.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Louis Aslett &lt;louis.aslett@durham.ac.uk&gt;</p>
<p>Mike Giles &lt;Mike.Giles@maths.ox.ac.uk&gt;</p>
<p>Tigran Nagapetyan &lt;nagapetyan@stats.ox.ac.uk&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Example calls with realistic arguments</span></span></span>
<span class="r-in"><span><span class="co"># Financial options using an Euler-Maruyama discretisation</span></span></span>
<span class="r-in"><span><span class="va">tst</span> <span class="op">&lt;-</span> <span class="fu">mlmc.test</span><span class="op">(</span><span class="va">opre_l</span>, N <span class="op">=</span> <span class="fl">2000000</span>,</span></span>
<span class="r-in"><span>                 L <span class="op">=</span> <span class="fl">5</span>, N0 <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                 eps.v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 Lmin <span class="op">=</span> <span class="fl">2</span>, Lmax <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>                 option <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Convergence tests, kurtosis, telescoping sum check ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** using N = 2e+06 samples                            ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  l   ave(Pf-Pc)    ave(Pf)   var(Pf-Pc)    var(Pf)    kurtosis      check       cost</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0   1.0209e+01  1.0209e+01  1.6139e+02  1.6139e+02  0.0000e+00  0.0000e+00  1.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1   2.0971e-01  1.0420e+01  4.4439e+00  2.0102e+02  2.0055e+01  2.9916e-02  4.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2   2.9164e-02  1.0443e+01  1.0641e+00  2.1243e+02  1.2387e+01  9.3236e-02  1.6000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3   5.8030e-03  1.0457e+01  2.7256e-01  2.1538e+02  7.5182e+00  1.1818e-01  6.4000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4   1.6226e-03  1.0450e+01  6.8529e-02  2.1643e+02  6.2241e+00  1.3021e-01  2.5600e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5   5.6870e-04  1.0456e+01  1.7268e-02  2.1633e+02  5.9348e+00  8.0291e-02  1.0240e+03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Linear regression estimates of MLMC parameters ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha = 2.122090  (exponent for MLMC weak convergence)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  beta  = 1.997195  (exponent for MLMC variance) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gamma = 2.000000  (exponent for MLMC cost) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** MLMC complexity tests *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eps      value    mlmc_cost   std_cost  savings     N_l </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0050  1.0449e+01  4.625e+07  2.955e+09    63.88  19941583   1650853    405719    103214     25829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0100  1.0454e+01  8.433e+06  1.838e+08    21.80   4257398    354804     85692     21643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0200  1.0449e+01  2.127e+06  4.595e+07    21.60   1068793     88086     22057      5520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0500  1.0440e+01  2.519e+05  1.813e+06     7.20    159399     11284      2959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1000  1.0495e+01  6.324e+04  4.532e+05     7.17     35177      3016      1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">tst</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Convergence tests, kurtosis, telescoping sum check ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** using N = 2e+06 samples                            ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  l   ave(Pf-Pc)    ave(Pf)   var(Pf-Pc)    var(Pf)    kurtosis      check       cost</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0   1.0209e+01  1.0209e+01  1.6139e+02  1.6139e+02  0.0000e+00  0.0000e+00  1.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1   2.0971e-01  1.0420e+01  4.4439e+00  2.0102e+02  2.0055e+01  2.9916e-02  4.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2   2.9164e-02  1.0443e+01  1.0641e+00  2.1243e+02  1.2387e+01  9.3236e-02  1.6000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3   5.8030e-03  1.0457e+01  2.7256e-01  2.1538e+02  7.5182e+00  1.1818e-01  6.4000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4   1.6226e-03  1.0450e+01  6.8529e-02  2.1643e+02  6.2241e+00  1.3021e-01  2.5600e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5   5.6870e-04  1.0456e+01  1.7268e-02  2.1633e+02  5.9348e+00  8.0291e-02  1.0240e+03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Linear regression estimates of MLMC parameters ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha = 2.122090  (exponent for MLMC weak convergence)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  beta  = 1.997195  (exponent for MLMC variance) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gamma = 2.000000  (exponent for MLMC cost) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** MLMC complexity tests *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eps      value    mlmc_cost   std_cost  savings     N_l </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0050  1.0449e+01  4.625e+07  2.955e+09    63.88  19941583   1650853    405719    103214     25829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0100  1.0454e+01  8.433e+06  1.838e+08    21.80   4257398    354804     85692     21643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0200  1.0449e+01  2.127e+06  4.595e+07    21.60   1068793     88086     22057      5520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0500  1.0440e+01  2.519e+05  1.813e+06     7.20    159399     11284      2959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1000  1.0495e+01  6.324e+04  4.532e+05     7.17     35177      3016      1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tst</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mlmc.test-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Financial options using a Milstein discretisation</span></span></span>
<span class="r-in"><span><span class="va">tst</span> <span class="op">&lt;-</span> <span class="fu">mlmc.test</span><span class="op">(</span><span class="va">mcqmc06_l</span>, N <span class="op">=</span> <span class="fl">20000</span>,</span></span>
<span class="r-in"><span>                 L <span class="op">=</span> <span class="fl">8</span>, N0 <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>                 eps.v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 Lmin <span class="op">=</span> <span class="fl">2</span>, Lmax <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                 option <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Convergence tests, kurtosis, telescoping sum check ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** using N = 20000 samples                            ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  l   ave(Pf-Pc)    ave(Pf)   var(Pf-Pc)    var(Pf)    kurtosis      check       cost</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0   1.0133e+01  1.0133e+01  1.9810e+02  1.9810e+02  0.0000e+00  0.0000e+00  1.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1   1.8339e-01  1.0238e+01  1.4650e-01  2.0666e+02  4.3668e+01  1.2791e-01  2.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2   1.0178e-01  1.0207e+01  4.1696e-02  2.0649e+02  3.1277e+01  2.1643e-01  4.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3   5.4679e-02  1.0390e+01  1.2096e-02  2.1192e+02  2.2094e+01  2.0862e-01  8.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4   2.7491e-02  1.0312e+01  3.0769e-03  2.1030e+02  1.2999e+01  1.7120e-01  1.6000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5   1.3946e-02  1.0439e+01  8.5509e-04  2.2017e+02  1.3315e+01  1.8132e-01  3.2000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6   6.9500e-03  1.0260e+01  2.1296e-04  2.1398e+02  1.1626e+01  2.9709e-01  6.4000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7   3.5764e-03  1.0542e+01  5.3863e-05  2.1728e+02  9.9385e+00  4.4704e-01  1.2800e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8   1.8070e-03  1.0587e+01  1.3390e-05  2.1707e+02  9.4222e+00  6.9319e-02  2.5600e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Linear regression estimates of MLMC parameters ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha = 0.960913  (exponent for MLMC weak convergence)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  beta  = 1.919459  (exponent for MLMC variance) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gamma = 1.000000  (exponent for MLMC cost) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** MLMC complexity tests *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eps      value    mlmc_cost   std_cost  savings     N_l </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0050  1.0447e+01  1.355e+07  2.964e+09   218.65  11903219    229699     88580     33052     12456      4446      1600       569       220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0100  1.0438e+01  3.363e+06  3.708e+08   110.27   2957414     56143     25072      8068      2875      1106       426       155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0200  1.0468e+01  9.014e+05  4.565e+07    50.64    795790     15288      8075      2046       735       266        96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0500  1.0432e+01  1.313e+05  3.758e+06    28.62    116815      2610       840       297       127        46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1000  1.0251e+01  3.492e+04  4.486e+05    12.85     31940       613       200        65        27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">tst</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Convergence tests, kurtosis, telescoping sum check ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** using N = 20000 samples                            ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  l   ave(Pf-Pc)    ave(Pf)   var(Pf-Pc)    var(Pf)    kurtosis      check       cost</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0   1.0133e+01  1.0133e+01  1.9810e+02  1.9810e+02  0.0000e+00  0.0000e+00  1.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1   1.8339e-01  1.0238e+01  1.4650e-01  2.0666e+02  4.3668e+01  1.2791e-01  2.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2   1.0178e-01  1.0207e+01  4.1696e-02  2.0649e+02  3.1277e+01  2.1643e-01  4.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3   5.4679e-02  1.0390e+01  1.2096e-02  2.1192e+02  2.2094e+01  2.0862e-01  8.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4   2.7491e-02  1.0312e+01  3.0769e-03  2.1030e+02  1.2999e+01  1.7120e-01  1.6000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5   1.3946e-02  1.0439e+01  8.5509e-04  2.2017e+02  1.3315e+01  1.8132e-01  3.2000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6   6.9500e-03  1.0260e+01  2.1296e-04  2.1398e+02  1.1626e+01  2.9709e-01  6.4000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7   3.5764e-03  1.0542e+01  5.3863e-05  2.1728e+02  9.9385e+00  4.4704e-01  1.2800e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8   1.8070e-03  1.0587e+01  1.3390e-05  2.1707e+02  9.4222e+00  6.9319e-02  2.5600e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Linear regression estimates of MLMC parameters ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha = 0.960913  (exponent for MLMC weak convergence)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  beta  = 1.919459  (exponent for MLMC variance) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gamma = 1.000000  (exponent for MLMC cost) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** MLMC complexity tests *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eps      value    mlmc_cost   std_cost  savings     N_l </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0050  1.0447e+01  1.355e+07  2.964e+09   218.65  11903219    229699     88580     33052     12456      4446      1600       569       220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0100  1.0438e+01  3.363e+06  3.708e+08   110.27   2957414     56143     25072      8068      2875      1106       426       155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0200  1.0468e+01  9.014e+05  4.565e+07    50.64    795790     15288      8075      2046       735       266        96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0500  1.0432e+01  1.313e+05  3.758e+06    28.62    116815      2610       840       297       127        46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1000  1.0251e+01  3.492e+04  4.486e+05    12.85     31940       613       200        65        27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tst</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mlmc.test-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Toy versions for CRAN tests</span></span></span>
<span class="r-in"><span><span class="va">tst</span> <span class="op">&lt;-</span> <span class="fu">mlmc.test</span><span class="op">(</span><span class="va">opre_l</span>, N <span class="op">=</span> <span class="fl">10000</span>,</span></span>
<span class="r-in"><span>                 L <span class="op">=</span> <span class="fl">5</span>, N0 <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                 eps.v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 Lmin <span class="op">=</span> <span class="fl">2</span>, Lmax <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>                 option <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Convergence tests, kurtosis, telescoping sum check ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** using N = 10000 samples                            ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  l   ave(Pf-Pc)    ave(Pf)   var(Pf-Pc)    var(Pf)    kurtosis      check       cost</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0   1.0144e+01  1.0144e+01  1.5933e+02  1.5933e+02  0.0000e+00  0.0000e+00  1.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1   2.0461e-01  1.0494e+01  4.3545e+00  2.0017e+02  1.6552e+01  1.6836e-01  4.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2   3.4172e-02  1.0188e+01  1.0920e+00  2.0313e+02  1.3486e+01  3.8611e-01  1.6000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3   2.7394e-03  1.0609e+01  2.7241e-01  2.1473e+02  8.9020e+00  4.7445e-01  6.4000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4   4.6225e-03  1.0487e+01  7.0387e-02  2.2204e+02  6.2642e+00  1.4175e-01  2.5600e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5   2.3568e-03  1.0375e+01  1.6529e-02  2.1034e+02  5.6902e+00  1.2895e-01  1.0240e+03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Linear regression estimates of MLMC parameters ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha = 1.576591  (exponent for MLMC weak convergence)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  beta  = 2.003820  (exponent for MLMC variance) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gamma = 2.000000  (exponent for MLMC cost) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** MLMC complexity tests *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eps      value    mlmc_cost   std_cost  savings     N_l </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0250  1.0442e+01  1.352e+06  2.932e+07    21.68    682155     56440     13888      3468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1000  1.0326e+01  6.651e+04  4.333e+05     6.52     38193      3079      1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tst</span> <span class="op">&lt;-</span> <span class="fu">mlmc.test</span><span class="op">(</span><span class="va">mcqmc06_l</span>, N <span class="op">=</span> <span class="fl">10000</span>,</span></span>
<span class="r-in"><span>                 L <span class="op">=</span> <span class="fl">8</span>, N0 <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                 eps.v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 Lmin <span class="op">=</span> <span class="fl">2</span>, Lmax <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                 option <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Convergence tests, kurtosis, telescoping sum check ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** using N = 10000 samples                            ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **********************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  l   ave(Pf-Pc)    ave(Pf)   var(Pf-Pc)    var(Pf)    kurtosis      check       cost</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0   9.7083e+00  9.7083e+00  1.8872e+02  1.8872e+02  0.0000e+00  0.0000e+00  1.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1   1.8889e-01  1.0493e+01  1.5689e-01  2.1033e+02  4.2469e+01  6.9418e-01  2.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2   1.0293e-01  1.0345e+01  4.1077e-02  2.1021e+02  2.5473e+01  2.8726e-01  4.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3   5.2791e-02  1.0138e+01  1.1696e-02  2.1027e+02  2.0845e+01  2.9683e-01  8.0000e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4   2.7545e-02  1.0462e+01  3.1582e-03  2.1956e+02  1.3111e+01  3.3625e-01  1.6000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5   1.4108e-02  1.0503e+01  7.9526e-04  2.1093e+02  1.2555e+01  2.9865e-02  3.2000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6   6.8579e-03  1.0170e+01  2.0129e-04  2.1102e+02  9.9169e+00  3.8931e-01  6.4000e+01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7   3.5937e-03  1.0490e+01  5.4733e-05  2.1709e+02  1.2669e+01  3.6073e-01  1.2800e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8   1.7843e-03  1.0185e+01  1.3757e-05  2.1383e+02  9.7348e+00  3.4885e-01  2.5600e+02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Linear regression estimates of MLMC parameters ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ******************************************************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha = 0.965258  (exponent for MLMC weak convergence)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  beta  = 1.924650  (exponent for MLMC variance) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gamma = 1.000000  (exponent for MLMC cost) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** MLMC complexity tests *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***************************** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eps      value    mlmc_cost   std_cost  savings     N_l </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0250  1.0446e+01  5.278e+05  2.881e+07    54.59    468086      9101      3436      1207       505       183        65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1000  1.0334e+01  3.549e+04  4.684e+05    13.20     28562      1000      1000        76        20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Maintained by Louis Aslett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

